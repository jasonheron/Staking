"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.stripFwHeaders = exports.shouldStripFwHeaders = void 0;
const tslib_1 = require("tslib");
const versionUtils = tslib_1.__importStar(require("@trezor/utils/lib/versionUtils"));
const shouldStripFwHeaders = (features) => {
    if (features.major_version === 2)
        return false;
    return versionUtils.isNewerOrEqual([features.major_version, features.minor_version, features.patch_version], [1, 8, 0]);
};
exports.shouldStripFwHeaders = shouldStripFwHeaders;
const stripFwHeaders = (fw) => {
    const fwView = new Uint8Array(fw);
    if (String.fromCharCode(...Array.from(fwView.slice(0, 4))) === 'TRZR' &&
        String.fromCharCode(...Array.from(fwView.slice(256, 260))) === 'TRZF') {
        return fw.slice(256);
    }
    return fw;
};
exports.stripFwHeaders = stripFwHeaders;
//# sourceMappingURL=modifyFirmware.js.map